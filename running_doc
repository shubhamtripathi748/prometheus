management.endpoints.web.exposure.include=*
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true
management.endpoint.health.show-details=always

Caused by: java.lang.ClassNotFoundException: io.prometheus.client.CollectorRegistry


@Bean
public CollectorRegistry collectorRegistry() {
    return CollectorRegistry.defaultRegistry;
}

io.prometheus.client.CollectorRegistry


org.springframework.web.util.NestedServletException: Handler dispatch failed; nested exception is java.lang.NoClassDefFoundError: io/prometheus/client/exporter/common/TextFormat
